{{>layouts/header}}

<div class="container-fluid schedule-hub-container">
    <!-- ğŸ”¹ ê¸‰ì—¬ ê´€ë¦¬ í—ˆë¸Œ íƒ­ í—¤ë” -->
    <ul class="nav nav-tabs schedule-hub-tabs" id="paymentHubTabs" role="tablist">
        <!-- 1) ê¸‰ì—¬ê´€ë¦¬ (/payment) -->
        <li class="nav-item" role="presentation">
            <a
                    class="nav-link active"
                    id="payment-main-tab-btn"
                    data-bs-toggle="tab"
                    data-toggle="tab"
                    href="#payment-main-tab"
                    role="tab"
                    aria-controls="payment-main-tab"
                    aria-selected="true">
                ê°œì¸ë³„ê´€ë¦¬
            </a>
        </li>

        <!-- 2) ê¸‰ì—¬ê´€ë¦¬í˜„í™© (/payment/paymanagerdashboard) -->
        <li class="nav-item" role="presentation">
            <a
                    class="nav-link"
                    id="payment-manager-tab-btn"
                    data-bs-toggle="tab"
                    data-toggle="tab"
                    href="#payment-manager-tab"
                    role="tab"
                    aria-controls="payment-manager-tab"
                    aria-selected="false">
                ì „ì²´ê¸‰ì—¬ë‚´ì—­ë³´ê¸°
            </a>
        </li>

        <!-- 3) ê°œë³„ì§€ê¸‰í˜„í™© (/payment/payid) -->
        <li class="nav-item" role="presentation">
            <a
                    class="nav-link"
                    id="payment-id-tab-btn"
                    data-bs-toggle="tab"
                    data-toggle="tab"
                    href="#payment-id-tab"
                    role="tab"
                    aria-controls="payment-id-tab"
                    aria-selected="false">
                ê°œì¸ë³„ì§€ê¸‰ë‚´ì—­ë³´ê¸°
            </a>
        </li>

        <!-- 4) ì „ì²´ì§€ê¸‰í˜„í™© (/payment/payiddashboard) -->
        <li class="nav-item" role="presentation">
            <a
                    class="nav-link"
                    id="payment-id-all-tab-btn"
                    data-bs-toggle="tab"
                    data-toggle="tab"
                    href="#payment-id-all-tab"
                    role="tab"
                    aria-controls="payment-id-all-tab"
                    aria-selected="false">
                ì „ì²´ì§€ê¸‰ë‚´ì—­ë³´ê¸°
            </a>
        </li>
    </ul>

    <!-- ğŸ”¹ íƒ­ ì»¨í…ì¸  -->
    <div class="tab-content schedule-hub-content" id="paymentHubTabContent">

        <!-- 1) ê¸‰ì—¬ê´€ë¦¬: @GetMapping("/payment") -->
        <!-- âš ï¸ ì´ í—ˆë¸Œ í˜ì´ì§€ì˜ ë§¤í•‘ì€ /payment/hub ì²˜ëŸ¼ ë”°ë¡œ ë‘ê³ ,
             ì´ iframe ì€ ì‹¤ì œ ê¸‰ì—¬ê´€ë¦¬ í™”ë©´(/payment)ì— ì—°ê²°í•˜ëŠ” ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤. -->
        <div
                class="tab-pane fade show active schedule-hub-pane"
                id="payment-main-tab"
                role="tabpanel"
                aria-labelledby="payment-main-tab-btn">
            <iframe
                    id="payment-main-frame"
                    class="schedule-hub-iframe"
                    src="/payment"
                    title="ê¸‰ì—¬ê´€ë¦¬"
                    style="width:100%; border:none; min-height:calc(100vh - 180px);">
            </iframe>
        </div>

        <!-- 2) ê¸‰ì—¬ê´€ë¦¬í˜„í™©: @GetMapping("/payment/paymanagerdashboard") -->
        <div
                class="tab-pane fade schedule-hub-pane"
                id="payment-manager-tab"
                role="tabpanel"
                aria-labelledby="payment-manager-tab-btn">
            <!-- lazy-load: ì²˜ìŒì—” data-src ë§Œ ì„¤ì • -->
            <iframe
                    id="payment-manager-frame"
                    class="schedule-hub-iframe"
                    data-src="/payment/paymanagerdashboard"
                    title="ê¸‰ì—¬ê´€ë¦¬í˜„í™©"
                    style="width:100%; border:none; min-height:calc(100vh - 180px);">
            </iframe>
        </div>

        <!-- 3) ê°œë³„ì§€ê¸‰í˜„í™©: @GetMapping("/payment/payid") -->
        <div
                class="tab-pane fade schedule-hub-pane"
                id="payment-id-tab"
                role="tabpanel"
                aria-labelledby="payment-id-tab-btn">
            <!-- lazy-load -->
            <iframe
                    id="payment-id-frame"
                    class="schedule-hub-iframe"
                    data-src="/payment/payid"
                    title="ê°œë³„ì§€ê¸‰í˜„í™©"
                    style="width:100%; border:none; min-height:calc(100vh - 180px);">
            </iframe>
        </div>

        <!-- 4) ì „ì²´ì§€ê¸‰í˜„í™©: @GetMapping("/payment/payiddashboard") -->
        <div
                class="tab-pane fade schedule-hub-pane"
                id="payment-id-all-tab"
                role="tabpanel"
                aria-labelledby="payment-id-all-tab-btn">
            <!-- lazy-load -->
            <iframe
                    id="payment-id-all-frame"
                    class="schedule-hub-iframe"
                    data-src="/payment/payiddashboard"
                    title="ì „ì²´ì§€ê¸‰í˜„í™©"
                    style="width:100%; border:none; min-height:calc(100vh - 180px);">
            </iframe>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const tabLinks = document.querySelectorAll('#paymentHubTabs .nav-link');
        const tabPanes = document.querySelectorAll('#paymentHubTabContent .tab-pane');

        tabLinks.forEach(function (link) {
            link.addEventListener('click', function (e) {
                e.preventDefault();

                const targetSelector = link.getAttribute('href');
                const targetPane = document.querySelector(targetSelector);

                // 1) Bootstrap 5 (JS) ê°€ ìˆìœ¼ë©´ ê·¸ê±¸ ì‚¬ìš©
                if (window.bootstrap && bootstrap.Tab) {
                    const tab = new bootstrap.Tab(link);
                    tab.show();
                }
                // 2) Bootstrap 4 (jQuery) ê°€ ìˆìœ¼ë©´ ê·¸ê±¸ ì‚¬ìš©
                else if (window.$ && typeof $(link).tab === 'function') {
                    $(link).tab('show');
                }
                // 3) ë‘˜ ë‹¤ ì—†ìœ¼ë©´ ìˆœìˆ˜ JSë¡œ ê°•ì œ í† ê¸€
                else {
                    tabLinks.forEach(function (l) {
                        l.classList.remove('active');
                    });
                    tabPanes.forEach(function (p) {
                        p.classList.remove('show', 'active');
                    });
                    link.classList.add('active');
                    if (targetPane) {
                        targetPane.classList.add('show', 'active');
                    }
                }

                // âœ… ê³µí†µ lazy-load ì²˜ë¦¬:
                //   í™œì„±í™”ëœ íƒ­ pane ì•ˆì— data-src ê°€ ìˆëŠ” iframe ì´ë©´
                //   ìµœì´ˆ í´ë¦­ ì‹œì—ë§Œ src ì„¸íŒ…
                if (targetPane) {
                    const iframe = targetPane.querySelector('iframe[data-src]');
                    if (iframe && !iframe.src) {
                        const dataSrc = iframe.getAttribute('data-src');
                        if (dataSrc) {
                            iframe.src = dataSrc;
                        }
                    }
                }
            });
        });
    });
</script>

{{>layouts/footer}}
